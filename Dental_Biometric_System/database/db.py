
# service mysql restart
# to login:
#mysql -u root      
# to see dbs
# show daatabases;
#to delete database
# DROP DATABASE IF EXISTS forensic_dental_biometrics;


import json
import mysql.connector
from mysql.connector import Error

Extracted_features = [4.055728912353516, 0.0, 0.0, 0.0, 0.0, 0.2397124171257019, 0.12310437858104706, 4.564732074737549, 0.5475394129753113, 0.0, 5.469888687133789, 0.07815627753734589, 2.5013322830200195, 4.51550817489624, 0.23727132380008698, 0.0, 3.7202908992767334, 1.3224601745605469, 0.0, 0.0, 0.18671256303787231, 0.0, 0.0, 3.575124740600586, 1.2920266389846802, 2.153146982192993, 1.0284398794174194, 1.794719934463501, 2.202596426010132, 3.284104347229004, 0.42399945855140686, 0.0, 0.0, 1.5103645324707031, 2.7717301845550537, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4916311502456665, 0.0, 0.029784560203552246, 0.0, 4.709959030151367, 4.686092376708984, 1.4514676332473755, 0.6389820575714111, 4.479828834533691, 7.0984954833984375, 0.0, 1.0259644985198975, 0.2766735851764679, 0.0, 0.0, 0.0, 1.8344770669937134, 0.0, 0.0, 0.37831732630729675, 0.9565680623054504, 4.355642795562744, 6.978322982788086, 0.0, 0.0, 2.158097267150879, 0.0, 1.9527041912078857, 1.433119297027588, 0.0, 0.0, 0.0, 0.5094999074935913, 1.4063063859939575, 0.0, 0.0, 0.7558457255363464, 1.223260521888733, 4.320272445678711, 0.0, 1.0000736713409424, 0.32864537835121155, 0.0, 0.0, 2.1650021076202393, 0.0, 3.1868896484375, 4.053633213043213, 2.7509169578552246, 0.0, 0.0, 0.0, 3.4598257541656494, 0.0, 3.4862468242645264, 2.025306224822998, 0.0, 0.0, 1.0615601539611816, 0.0, 0.9534704685211182, 0.0, 0.0, 0.7092182040214539, 3.093297243118286, 5.559602737426758, 2.9034512042999268, 1.7202872037887573, 3.5068986415863037, 0.0, 0.0, 1.3630361557006836, 0.0, 0.11376753449440002, 0.0, 1.8492285013198853, 0.5164842009544373, 0.6153395175933838, 0.0, 0.0, 1.6558654308319092, 0.8419553637504578, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0781749486923218, 0.0, 3.865384101867676, 0.0, 0.4864411950111389, 5.1857075691223145, 0.0, 2.220005989074707, 5.745832443237305, 0.9675562381744385, 0.0, 5.108558654785156, 1.7214350700378418, 3.1865060329437256, 0.0, 0.0, 0.0, 3.1613426208496094, 1.0129553079605103, 0.0, 2.442213773727417, 0.2880883812904358, 0.0, 0.0, 0.0, 0.0, 0.0, 0.34202930331230164, 0.0, 0.0, 0.0, 0.0, 0.08593086898326874, 0.0, 5.076853275299072, 0.0, 0.0, 0.0, 5.031320571899414, 1.1753889322280884, 0.0555647648870945, 0.6340805292129517, 1.047418236732483, 0.0, 4.337291717529297, 0.0, 0.0, 0.0, 0.0, 3.333439350128174, 1.444279432296753, 0.0, 0.0, 2.007612943649292, 0.7428783774375916, 0.5591728091239929, 0.0, 2.597158193588257, 2.184887170791626, 0.0, 0.0, 0.0, 1.0598454475402832, 1.670259714126587, 1.416968584060669, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6177048087120056, 5.515191078186035, 1.6006585359573364, 0.0, 0.8462988138198853, 0.0, 1.7516634464263916, 4.1386518478393555, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.040480136871338, 1.5311884880065918, 0.0, 0.0, 1.3764071464538574, 2.9932568073272705, 1.8199516534805298, 0.0, 1.4143887758255005, 0.0, 3.359741687774658, 0.5332782864570618, 0.0, 2.42582368850708, 2.67759108543396, 0.0, 0.0, 0.0, 0.0, 0.12407621741294861, 0.0, 0.0, 2.627612352371216, 3.6146109104156494, 0.9270299077033997, 0.0, 3.913400650024414, 0.0, 3.0066163539886475, 4.355900287628174, 0.8975783586502075, 0.0, 2.0609498023986816, 0.0, 0.5833361148834229, 5.2142839431762695, 0.0, 2.0891194343566895, 0.0, 0.47767671942710876, 3.7755279541015625, 0.0, 0.0, 0.3106096386909485, 1.1333189010620117, 6.325705051422119, 4.876668453216553, 2.966183662414551, 0.0, 0.0, 0.0, 0.0, 0.5183771848678589, 0.0, 2.695218563079834, 0.0, 1.7834880352020264, 0.0, 0.10984481871128082, 2.5555953979492188, 0.0, 1.7416958808898926, 1.5367350578308105, 0.0, 2.6979846954345703, 0.0, 0.49916672706604004, 0.0, 1.980731725692749, 1.9851452112197876, 0.0, 0.8884632587432861, 0.0, 2.5963549613952637, 0.4668988585472107, 0.0, 3.778797149658203, 0.0, 1.2375028133392334, 0.4318894147872925, 0.0, 0.5022740364074707, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.780747413635254, 2.3919451236724854, 0.0, 0.48668980598449707, 1.8850617408752441, 0.0, 0.0, 0.20355156064033508, 0.0, 0.0, 5.268822193145752, 1.5161564350128174, 4.610451698303223, 0.997444212436676, 0.0, 0.0, 2.1825239658355713, 4.5207014083862305, 0.44266390800476074, 2.015882730484009, 2.163299083709717, 0.0, 4.2223591804504395, 0.0, 1.6241101026535034, 0.0, 1.4930833578109741, 4.29081392288208, 2.048387050628662, 0.0, 1.6407558917999268, 0.0, 0.7817744016647339, 0.0, 0.0, 1.39029860496521, 0.0, 2.8460872173309326, 0.0, 0.0, 0.0, 3.1330318450927734, 0.0, 0.0, 0.0, 0.8815805912017822, 0.0, 0.0, 0.0, 3.221932888031006, 0.931266188621521, 0.6298618316650391, 1.1774359941482544, 2.990393877029419, 0.0, 1.3192050457000732, 0.0, 0.0, 0.0, 0.0, 0.7280378937721252, 0.0, 0.0, 3.3005008697509766, 1.456993818283081, 0.0, 0.7648386359214783, 0.801523745059967, 0.5873861312866211, 1.4801470041275024, 3.722921848297119, 5.036362648010254, 3.350984811782837, 0.9282970428466797, 0.06509405374526978, 0.6741576194763184, 0.0, 1.251058578491211, 0.0, 1.9471389055252075, 0.0, 0.0, 1.956686019897461, 0.0, 0.0, 0.0, 0.0, 2.4613211154937744, 2.2884433269500732, 0.019324779510498047, 0.0, 4.2235941886901855, 7.493433475494385, 0.0, 0.0, 1.6208211183547974, 3.369859218597412, 0.0, 0.0, 0.0, 0.0, 0.735953152179718, 0.0, 0.0, 0.7318789958953857, 0.0, 2.9032459259033203, 0.0, 0.0, 0.477477103471756, 0.0, 0.041933655738830566, 0.0, 0.0, 0.0, 1.3722593784332275, 0.3460315465927124, 0.0, 0.0, 0.0, 1.9488922357559204, 0.9903272390365601, 0.0, 0.0, 1.5592199563980103, 0.0, 1.6846275329589844, 0.0, 0.0, 0.0, 1.2235002517700195, 0.6916322708129883, 0.0, 2.654573678970337, 0.5412086844444275, 1.2479832172393799, 0.0, 0.5294054746627808, 0.0, 0.0, 4.021795749664307, 2.525742769241333, 0.0, 0.0, 0.0, 0.0, 3.6840028762817383, 1.8348278999328613, 0.0, 0.0, 4.1225666999816895, 0.6023649573326111, 1.8631342649459839, 0.0, 0.0, 0.0, 0.542312741279602, 0.0, 0.6458850502967834, 0.5466245412826538, 2.0390141010284424, 1.3417772054672241, 0.4383043050765991, 4.331009864807129, 2.9513192176818848, 0.0, 0.0, 0.0, 0.0, 0.7676001787185669, 1.9447840452194214, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1872951984405518, 0.0, 2.7274816036224365, 1.6642119884490967, 0.8014583587646484, 0.0, 0.0, 0.0, 0.0, 3.0681514739990234, 0.0, 0.0, 2.924546957015991, 0.0, 3.223146915435791, 0.5087323188781738, 0.0, 1.2766880989074707, 1.784703254699707, 0.9449671506881714, 0.10345298796892166, 0.77455735206604, 0.0, 0.0, 0.0, 2.2556567192077637, 0.0, 3.0125749111175537, 0.2715027928352356, 1.0178258419036865, 0.9347549080848694, 1.0819649696350098, 2.121938467025757, 0.0, 1.0493909120559692, 0.0, 0.0, 0.0, 0.0, 1.2757976055145264, 0.0, 0.0, 3.9361634254455566, 0.0, 4.961396217346191, 0.49119681119918823, 2.243921995162964, 0.0, 0.0, 0.0, 2.626042127609253, 0.4557230472564697, 0.0, 1.757069706916809, 0.0, 0.036010220646858215, 2.1195480823516846, 0.4378077983856201, 2.6949281692504883, 0.0, 0.0, 1.5874450206756592, 0.07959309220314026, 0.0, 3.0788097381591797, 2.4592995643615723, 2.1581413745880127, 0.0, 0.0, 0.0, 2.842167854309082, 0.5027811527252197, 1.0468319654464722, 0.0, 0.42783278226852417, 0.0, 2.3461410999298096, 2.610837936401367, 0.023887261748313904, 0.0, 0.0, 3.0182666778564453, 0.0, 2.183100700378418, 4.522635459899902, 0.0, 1.4624298810958862, 2.0244669914245605, 0.0, 0.0, 0.0, 1.2491246461868286, 1.3970478773117065, 5.505169868469238, 2.807741165161133, 1.5597201585769653, 2.9903197288513184, 1.5488951206207275, 0.5017001628875732, 0.0, 0.0, 0.0, 0.6760244369506836, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6990096569061279, 0.0, 0.0, 0.057138144969940186, 1.213212013244629, 0.0, 2.0143423080444336, 0.0, 2.235311985015869, 0.22188934683799744, 7.078887939453125, 2.2865874767303467, 1.080331802368164, 0.8664215803146362, 0.0, 0.0, 2.326430320739746, 0.0, 2.7822558879852295, 1.6445873975753784, 0.0, 0.15223920345306396, 2.020569086074829, 2.649174690246582, 1.279867172241211, 2.4914374351501465, 0.0, 1.7588810920715332, 0.0, 0.0, 0.0, 0.8488401174545288, 0.0, 0.0, 1.566725254058838, 0.08234317600727081, 0.7483668327331543, 0.3550124168395996, 2.8928916454315186, 0.0, 0.0, 0.0, 0.0, 3.7232396602630615, 0.0, 0.9886809587478638, 2.3401145935058594, 0.0, 0.0, 2.760404586791992, 0.0, 1.0101768970489502, 0.8204774856567383, 0.0, 0.0, 0.0, 0.0, 0.0, 1.9518544673919678, 0.0, 0.0, 0.0, 0.0, 1.8116286993026733, 4.762788772583008, 0.8628637194633484, 0.0, 0.0, 0.0, 0.0, 0.3058531880378723, 0.0, 0.0, 2.7254109382629395, 0.0, 0.0, 0.3979479670524597, 5.541308403015137, 0.9862546920776367, 2.9090194702148438, 0.0, 0.0, 2.762627124786377, 0.0, 2.5292606353759766, 0.0, 1.5814507007598877, 2.3091061115264893, 0.0, 0.0, 1.0505070686340332, 0.0, 1.1783547401428223, 2.3711512088775635, 0.0, 0.0, 0.09729015827178955, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1146427392959595, 0.0, 1.126239538192749, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.5985922813415527, 0.0, 4.063033580780029, 0.0, 0.0, 0.10320311784744263, 2.3574776649475098, 3.0023975372314453, 0.0, 0.0, 0.0, 0.0, 0.0, 1.619842290878296, 0.0, 0.0, 2.9043633937835693, 1.7443872690200806, 0.9335394501686096, 5.210067272186279, 2.8598475456237793, 0.0, 0.0, 0.0, 0.0, 0.53486567735672, 0.0, 0.0, 5.018505573272705, 0.10825610160827637, 0.03501863777637482, 4.418585300445557, 0.27238425612449646, 3.3293023109436035, 1.1002382040023804, 0.0, 0.0, 0.0, 1.450464129447937, 1.0026766061782837, 1.0732990503311157, 0.0, 8.505565643310547, 1.1323816776275635, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1980069875717163, 0.0, 0.0, 5.803662300109863, 0.0, 0.9911750555038452, 2.5683274269104004, 5.924224853515625, 0.08188171684741974, 0.06818783283233643, 0.0, 0.0, 0.0, 0.0, 1.7421276569366455, 0.0, 2.139899969100952, 0.0, 0.06939013302326202, 0.0, 3.1942691802978516, 2.829000473022461, 0.0, 3.1181068420410156, 3.705266237258911, 0.0, 0.0, 0.0, 0.0, 1.8790123462677002, 1.7117465734481812, 0.0, 1.5770920515060425, 0.9810870289802551, 2.1896512508392334, 0.0, 0.0, 1.0451929569244385, 2.252993583679199, 0.6443485617637634, 0.0, 0.0, 2.2743117809295654, 1.1798399686813354, 0.0, 1.4536662101745605, 0.0, 2.893439292907715, 2.490018844604492, 0.0, 1.3321311473846436, 1.634260892868042, 1.3074067831039429, 0.0, 1.42138671875, 1.1982671022415161, 0.07129360735416412, 0.0, 2.0184502601623535, 0.0, 0.0, 0.0, 0.0, 2.3824195861816406, 1.2712023258209229, 0.7839819192886353, 0.0, 2.2812225818634033, 2.449634552001953, 2.954282522201538, 0.0, 0.0, 0.0, 1.748906135559082, 2.504497528076172, 0.0, 3.609363555908203, 0.0, 0.0, 0.0, 0.9751082062721252, 0.0, 1.920127034187317, 0.29542797803878784, 2.4274401664733887, 0.0, 0.11278270184993744, 2.4951331615448, 0.0, 3.9603230953216553, 0.0, 0.2658899128437042, 1.799743413925171, 2.052682399749756, 1.1592912673950195, 0.0, 0.4241443872451782, 0.0, 0.0, 3.7142410278320312, 0.0, 2.354043483734131, 0.0, 3.310225486755371, 0.0, 2.6265172958374023, 2.7756848335266113, 1.4651600122451782, 0.0, 1.4336178302764893, 3.123115301132202, 0.0, 3.4376296997070312, 4.804665565490723, 2.61985445022583, 0.0, 0.0, 0.0, 1.1029399633407593, 1.835994005203247, 1.257222056388855, 0.9680518507957458, 1.212920904159546, 0.0, 3.079477310180664, 0.0, 1.6898969411849976, 3.5116829872131348, 2.608957529067993, 2.4831652641296387, 0.0, 0.0, 2.341820478439331, 0.0, 0.0, 0.7869278788566589, 1.7954521179199219, 0.9418654441833496, 0.0, 3.2851691246032715, 1.3383922576904297, 0.8590226769447327, 1.326871395111084, 0.0, 2.3217742443084717, 0.8614130616188049, 0.7026713490486145, 0.0, 0.0, 0.672516405582428, 2.62180233001709, 0.0, 0.18368320167064667, 2.6710667610168457, 0.0, 0.0, 0.0, 1.8402462005615234, 2.7132794857025146, 2.210721731185913, 0.0, 2.3886754512786865, 0.0, 2.125857353210449, 1.600115418434143, 3.160513401031494, 0.0, 0.0, 0.06724387407302856, 0.0, 0.0, 0.0, 0.0, 0.37505799531936646, 0.0, 2.4241561889648438, 0.0, 0.0, 1.8901423215866089, 0.0, 0.685191810131073, 0.0, 0.0, 2.1495251655578613, 0.823265790939331, 2.900027275085449, 2.0453004837036133, 1.8409346342086792, 0.0, 0.0, 4.256041049957275, 2.5411431789398193, 1.3478713035583496, 0.0, 0.0, 1.8897802829742432, 1.9799504280090332, 0.0, 0.0, 0.055786967277526855, 0.0, 0.6060329675674438, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.708083629608154, 0.04734635353088379, 0.0, 0.0, 0.0, 0.7885195016860962, 1.6576929092407227, 0.0, 0.0, 3.097932815551758, 2.89342999458313, 0.0, 0.0, 0.0, 0.0, 0.0, 1.9650239944458008, 0.0, 2.894503116607666, 0.8854869604110718, 0.0, 1.1762444972991943, 0.0, 0.11313055455684662, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.2647080421447754, 0.5846742391586304, 3.3992881774902344, 0.18454769253730774, 0.0, 0.8018109798431396, 0.0, 1.9789481163024902, 4.074799060821533, 2.2137930393218994, 1.9446477890014648, 0.0, 0.3852897882461548, 2.141974925994873, 2.4376485347747803, 0.3365668058395386, 2.7670235633850098, 0.852310836315155, 0.0, 0.0, 3.6266207695007324, 0.977069616317749, 0.0, 0.0, 0.0, 1.3546689748764038]

def create_database():
    try:
        connection = mysql.connector.connect(
            host="localhost",
            user="root",
            password="admin"  # Replace with your actual password
        )

        if connection.is_connected():
            cursor = connection.cursor()
            # Check if the database exists
            cursor.execute("SHOW DATABASES LIKE 'forensic_dental_biometrics'")
            database_exists = cursor.fetchone()

            if not database_exists:
                # Create the database if it doesn't exist
                cursor.execute("CREATE DATABASE forensic_dental_biometrics")
                print("Database created successfully")
            else:
                print("Database already exists")

    except Error as e:
        print(f"Error creating database: {e}")

    finally:
        if connection.is_connected():
            cursor.close()
            connection.close()
            print("Connection closed")





def create_connection():
    """Create a connection to the MySQL database."""
    try:
        connection = mysql.connector.connect(
            host="localhost",
            user="root",
            password="admin",
            database="forensic_dental_biometrics"
        )
        print("Connection to MySQL database successful")
        return connection
    except Error as e:
        print(f"The error '{e}' occurred while connecting to the database")
        return None

def table_exists(cursor, table_name):
    """Check if a table with the given name exists"""
    try:
        cursor.execute(f"SELECT 1 FROM {table_name} LIMIT 1")
        return True
    except Error:
        return False

def create_table(connection):
    """Create a table in the database to store the data if it does not exist"""
    try:
        cursor = connection.cursor()

        table_name = "users"
        
        if table_exists(cursor, table_name):
            print(f"Table '{table_name}' already exists")
        else:
            # Here, you can adjust the column names and data types as per your needs
            create_table_query = """
                CREATE TABLE {table_name} (
                    id INT AUTO_INCREMENT PRIMARY KEY,
                    name VARCHAR(255),
                    age INT,
                    gender VARCHAR(10),
                    state VARCHAR(255),
                    picture_address VARCHAR(255),
                    radiograph_address VARCHAR(255),
                    features TEXT

                )
            """
            cursor.execute(create_table_query)
            print(f"Table '{table_name}' created successfully")
    except Error as e:
        print(f"The error '{e}' occurred while creating or checking the table")

def save_data_to_db(connection, data):
    """Insert the data into the database"""
    try:
        cursor = connection.cursor()
        # Here, you can adjust the column names as per your needs
        insert_data_query = """
            INSERT INTO users(name, age, gender, state, picture_address, radiograph_address, features) 
            VALUES (%s, %s, %s, %s, %s, %s, %s)
        """
        insert_data_values = (
            data["name"],
            data["age"],
            data["gender"],
            data["state"],
            data["picture_address"],
            data["radiograph_address"],
            data["features"]
        )
        cursor.execute(insert_data_query, insert_data_values)
        connection.commit()
        print("Data saved successfully")
        
        
        cursor.execute("SELECT * FROM your_table")
        result = cursor.fetchall()
        print(result)
    except Error as e:
        print(f"The error '{e}' occurred while saving the data")

def close_connection(connection):
    """Close the connection to the MySQL database"""
    if connection:
        connection.close()
        print("Connection closed")

# Example usage:
def db_operations(name, age, gender, state, pic_address,radiograph_address, features_array ):
    # Call the function to create the database
    create_database()
    connection = create_connection()
    if connection:
        create_table(connection)

        # Sample data to be stored in the database
        data = {
            "name": "John Doe",
            "age": 30,
            "gender": "Male",
            "state": "California",
            "picture_address": "/path/to/picture.jpg",
            "radiograph_address": "/path/to/radiograph.jpg",
            "features": json.dumps(features_array)
        }

        save_data_to_db(connection, data)
        close_connection(connection)
        print("Details saved into Database")

if __name__ == "__main__":
    # create_database()
   db_operations("John Doe",30,"Male","California","/path/to/picture.jpg", "/path/to/radiograph.jpg", Extracted_features )


#                     